(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t,n){},140:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),s=n(9),a=n.n(s),i=n(41),o=n(12),j=(n(103),n(11)),u=n(30),b=n(92),l=n(169),O=n(2),d={winX:window.innerWidth,winY:window.innerHeight,user:"",room:"",theme:Object(b.a)({palette:{primary:{main:"#673ab7"},secondary:{main:"#2979ff"},tertiary:{main:"#1de9b6"}}})},h=function(e,t){switch(t.do){case"resize":return Object(u.a)(Object(u.a)({},e),{},{winX:window.innerWidth,winY:window.innerHeight});case"signin":return Object(u.a)(Object(u.a)({},e),{},{user:t.name,room:"Lobby"});default:throw new Error("Invalid action type: ".concat(t.do))}},f=Object(r.createContext)(),m=function(e){var t=Object(r.useReducer)(h,d),n=Object(j.a)(t,2),c=n[0],s=n[1];return Object(r.useEffect)((function(){function e(){s({do:"resize"})}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),Object(O.jsx)(f.Provider,{value:[c,s],children:Object(O.jsx)(l.a,{theme:c.theme,children:e.children})})},x=function(){return Object(r.useContext)(f)},v=n(170),g=n(173),p=n(174),w=n(175),y=n(176);var k=function(){var e=Object(o.f)();return Object(O.jsx)(v.a,{position:"static",children:Object(O.jsxs)(g.a,{variant:"dense",children:[Object(O.jsx)(p.a,{variant:"h6",style:{flexGrow:1},children:"Socket IM"}),Object(O.jsx)(w.a,{edge:"end",color:"inherit",onClick:function(){e.push("/")},children:Object(O.jsx)(y.a,{})})]})})},C=n(177),N=n(95),S=n(185),E=n(179);var R=function(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),n=t[0],c=t[1],s=x(),a=Object(j.a)(s,2)[1],i=Object(o.f)();function u(e){e.preventDefault(),a({do:"signin",name:n}),i.push("/chatroom")}return Object(O.jsx)(C.a,{maxWidth:"sm",style:{marginTop:"8rem"},children:Object(O.jsx)(N.a,{className:"main-card",elevation:3,children:Object(O.jsxs)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){return u(e)},children:[Object(O.jsx)("div",{style:{margin:"0.5rem 2rem"},children:Object(O.jsx)(S.a,{fullWidth:!0,label:"Username",variant:"standard",value:n,onChange:function(e){return c(e.target.value)}})}),Object(O.jsx)(E.a,{variant:"contained",color:"primary",onClick:function(e){return u(e)},children:"Enter Chatroom"})]})})})},M=n(181),T=n(184),L=n(91),W=n.n(L),z=n(93),I=n(178),U=n(180);var X=function(e){var t=Object(r.useState)([]),n=Object(j.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(""),i=Object(j.a)(a,2),o=i[0],u=i[1],b=Object(r.useRef)();function l(){e.sendMsg(o),u("")}return Object(r.useEffect)((function(){s([])}),[e.refresh]),Object(r.useEffect)((function(){var t=c;e.rMsg&&t.push(e.rMsg),t.length>20&&t.shift(),s(Object(z.a)(t))}),[e.rMsg]),Object(r.useEffect)((function(){b.current.scrollIntoView()})),Object(O.jsxs)(C.a,{disableGutters:!0,className:"msg-col",children:[Object(O.jsx)("div",{className:"msg-list",children:Object(O.jsxs)(I.a,{children:[c.map((function(e){return Object(O.jsxs)(U.a,{children:[e.user,": ",e.msg]})})),Object(O.jsx)("end",{ref:b})]})}),Object(O.jsxs)(M.a,{container:!0,className:"msg-input-area",children:[Object(O.jsx)(M.a,{xs:!0,item:!0,children:Object(O.jsx)("div",{style:{marginRight:"0.5rem"},children:Object(O.jsx)(S.a,{fullWidth:!0,size:"small",label:"New Message",variant:"filled",className:"msg-input",color:"secondary",value:o,onChange:function(e){return u(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&l()}})})}),Object(O.jsx)(M.a,{item:!0,children:Object(O.jsx)(E.a,{variant:"contained",onClick:l,color:"secondary",style:{marginTop:"0.3rem"},children:"Send"})})]})]})},G=n(37),F=n.n(G),H=n(55),J=n(182);var P=function(e){return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"room-tab",children:[Object(O.jsx)(p.a,{variant:"h6",children:"Room List"}),Object(O.jsx)(I.a,{children:e.rooms.map((function(t){return Object(O.jsx)(U.a,{button:!0,onClick:function(t){return e.joinRoom(t.target.innerText)},children:t})}))})]}),Object(O.jsx)("div",{className:"room-tab-bg",onClick:e.toggleTab})]})};var V=function(e){var t=Object(r.useState)([]),n=Object(j.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(!1),i=Object(j.a)(a,2),o=i[0],u=i[1],b=x(),l=Object(j.a)(b,1)[0];function d(){return(d=Object(H.a)(F.a.mark((function e(){var t;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/rooms").then((function(e){return e.json()}));case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){u((function(e){return!e}))}return Object(r.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[e.refresh]),l.winX>960?Object(O.jsxs)(C.a,{className:"room-col",children:[Object(O.jsx)(p.a,{variant:"h6",children:"Room List"}),Object(O.jsx)(I.a,{children:c.map((function(t){return Object(O.jsx)(U.a,{button:!0,onClick:function(t){return e.joinRoom(t.target.innerText)},children:t})}))})]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(C.a,{className:"room-col room-btn",onClick:h,children:Object(O.jsx)(J.a,{})}),o?Object(O.jsx)(P,{toggleTab:h,rooms:c,joinRoom:e.joinRoom}):""]})},Y=n(183);var B=function(e){return Object(O.jsxs)("div",{children:[Object(O.jsxs)("div",{className:"user-tab",children:[Object(O.jsx)(p.a,{variant:"h6",children:"User List"}),Object(O.jsx)(I.a,{children:e.users.map((function(e){return Object(O.jsx)(U.a,{children:e.name})}))})]}),Object(O.jsx)("div",{className:"user-tab-bg",onClick:e.toggleTab})]})};var D=function(e){var t=Object(r.useState)([]),n=Object(j.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(!1),i=Object(j.a)(a,2),o=i[0],u=i[1],b=x(),l=Object(j.a)(b,1)[0];function d(){return(d=Object(H.a)(F.a.mark((function e(){var t;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/users/".concat(l.room)).then((function(e){return e.json()}));case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){u((function(e){return!e}))}return Object(r.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[e.refresh]),l.winX>960?Object(O.jsxs)(C.a,{className:"user-col",children:[Object(O.jsx)(p.a,{variant:"h6",children:"User List"}),Object(O.jsx)(I.a,{children:c.map((function(e){return Object(O.jsx)(U.a,{children:e.name})}))})]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(C.a,{className:"user-col user-btn",onClick:h,children:Object(O.jsx)(Y.a,{})}),o?Object(O.jsx)(B,{toggleTab:h,users:c}):""]})};var K=function(){var e=Object(o.f)(),t=Object(r.useRef)(null),n=Object(r.useState)(!0),c=Object(j.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)(!0),b=Object(j.a)(i,2),l=b[0],d=b[1],h=Object(r.useState)(!0),f=Object(j.a)(h,2),m=f[0],v=f[1],g=Object(r.useState)(null),p=Object(j.a)(g,2),w=p[0],y=p[1],k=x(),N=Object(j.a)(k,1)[0];return Object(r.useEffect)((function(){return N.user||e.push("/"),t.current=W()(),t.current.emit("connected",{user:N.user,room:N.room}),t.current.on("msg",(function(e){return y(Object(u.a)({},e))})),t.current.on("refreshUsers",(function(){return v((function(e){return!e}))})),t.current.on("refreshRooms",(function(){return a((function(e){return!e}))})),t.current.on("refreshMsgs",(function(){return d((function(e){return!e}))})),function(){return t.current.disconnect()}}),[]),N.user?Object(O.jsx)(C.a,{maxWidth:"xl",disableGutters:!0,children:Object(O.jsxs)(M.a,{container:!0,spacing:0,fullWidth:!0,children:[Object(O.jsx)(M.a,{item:!0,xs:1,md:3,lg:2,children:Object(O.jsx)(V,{refresh:s,joinRoom:function(e){t.current.emit("leave",{user:N.user,room:N.room}),N.room=e,t.current.emit("join",{user:N.user,room:N.room})}})}),Object(O.jsx)(M.a,{item:!0,xs:10,md:6,lg:8,children:Object(O.jsx)(X,{rMsg:w,refresh:l,sendMsg:function(e){""!==e&&t.current.emit("msg",{user:N.user,room:N.room,msg:e})}})}),Object(O.jsx)(M.a,{item:!0,xs:1,md:3,lg:2,children:Object(O.jsx)(D,{refresh:m})})]})}):Object(O.jsx)(T.a,{className:"chatroom-card",children:"..."})};var q=function(){return Object(O.jsx)(m,{children:Object(O.jsxs)(i.a,{children:[Object(O.jsx)(k,{}),Object(O.jsxs)(o.c,{children:[Object(O.jsx)(o.a,{exact:!0,path:"/",children:Object(O.jsx)(R,{})}),Object(O.jsx)(o.a,{path:"/chatroom",children:Object(O.jsx)(K,{})})]})]})})};a.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(q,{})}),document.getElementById("root"))}},[[140,1,2]]]);
//# sourceMappingURL=main.4f8df018.chunk.js.map